# youtube

### Development environment
- React + Redux + node.js
- mongoDB + heroku

### Features
- Upload Video
- Subscribe / Unsubscribe
- Like / DisLike
- Comment / Reply a Comment

### Screenshots
<img width="1424" alt="Screen Shot 2020-03-13 at 5 05 20 PM" src="https://user-images.githubusercontent.com/33794732/76601945-47389880-654d-11ea-9424-8ec9b7f31bf7.png">
<img width="1429" alt="Screen Shot 2020-03-13 at 5 06 08 PM" src="https://user-images.githubusercontent.com/33794732/76601951-4b64b600-654d-11ea-8f08-9d0ad1a04c8a.png">
<img width="1411" alt="Screen Shot 2020-03-13 at 5 07 14 PM" src="https://user-images.githubusercontent.com/33794732/76601953-4c95e300-654d-11ea-8126-4be77eb202d1.png">
<img width="1427" alt="Screen Shot 2020-03-13 at 5 07 44 PM" src="https://user-images.githubusercontent.com/33794732/76601955-4dc71000-654d-11ea-8605-c1319dfe8e92.png">


### Todo ğŸ˜

#### Tips

vscode extention ì„¤ì¹˜! 

ES7 React/Redux/GraphQL/React-Native snippets

rfce, useState ë“± templateìë™ìƒì„±



ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë‹¤ë£¨ëŠ” ë°ì´í„°ëŠ” ë‘ê°œë¡œ ë‚˜ë‰œë‹¤. 

ë°”ë¡œ  **props ì™€ state!**

props ëŠ” ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ìì‹ ì»´í¬ë„ŒíŠ¸ì—ê²Œ ì£¼ëŠ” ê°’

ìì‹ ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” props ë¥¼ ë°›ì•„ì˜¤ê¸°ë§Œí•˜ê³ , ë°›ì•„ì˜¨ props ë¥¼ ì§ì ‘ ìˆ˜ì • í•  ìˆ˜ ì—†ìŒ

ë°˜ë©´ì— state ëŠ” ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ì„ ì–¸í•˜ë©° ë‚´ë¶€ì—ì„œ ê°’ì„ ë³€ê²½ í•  ìˆ˜ ìˆìŒ

**GETì€ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ê³  POSTëŠ” ìˆ˜í–‰í•˜ëŠ” ê²ƒ!**



#### How to kill port number

npx kill-port 3000

npx kill-port 5000



#### local environment

yarn npm run dev

dev: localì—ì„œ ê°œë°œ test

nodemon : ìë™ìœ¼ë¡œ ìˆ˜ì • ë°˜ì˜



#### multer ëª¨ë“ˆì‚¬ìš©

- ì‚¬ìš©ìê°€ ì•±ì—ê²Œ ì „ë‹¬í•˜ëŠ” ì •ë³´ëŠ” í¬ê²Œ `í…ìŠ¤íŠ¸`ì™€ `íŒŒì¼` 2ê°€ì§€ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.
- ì‚¬ìš©ìê°€ `íŒŒì¼`ì„ ì•±ì—ê²Œ ì „ë‹¬í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë³¸ë‹¤.
- ë™ì‘ ê°œìš”
  - íŒŒì¼ ì„ íƒ form
  - íŒŒì¼ ì„ íƒ í›„ submit ë²„íŠ¼ì„ ëˆŒë¥´ë©´ íŒŒì¼ ì „ì†¡
  - ë£¨íŠ¸ ë””ë ‰í† ë¦¬ ë‚´ uploads í´ë”ì— ì „ì†¡ëœ íŒŒì¼ì´ ì €ì¥
  - ì „ì†¡ëœ íŒŒì¼ëª…ì„ í™”ë©´ì— í‘œì‹œ
- expressëŠ” ì‚¬ìš©ìê°€ ì—…ë¡œë“œí•œ íŒŒì¼ì„ ë°›ì•„ì„œ ì €ì¥í•˜ëŠ” ê¸°ë³¸ ê¸°ëŠ¥ì„ ì œê³µí•˜ì§€ ì•ŠëŠ”ë‹¤.
- ë”°ë¼ì„œ ëª¨ë“ˆì„ ì„¤ì¹˜í•´ì„œ (ex. multer) ì‚¬ìš©ìê°€ ì „ì†¡í•œ íŒŒì¼ì„ ì²˜ë¦¬í•˜ëŠ” ì‘ì—…ì„ í•´ì•¼í•œë‹¤.
- `multer ëª¨ë“ˆ` ì„¤ì¹˜ì½”ë“œ (í„°ë¯¸ë„)


#### ffmpeg ì¸ë„¤ì¼ ìƒì„±í•˜ê¸°

brew install ffmpeg

npm install fluent-ffmpeg



#### ëœë”© í˜ì´ì§€ì— ë¹„ë””ì˜¤ë“¤ ë‚˜íƒ€ë‚˜ê²Œ í•˜ê¸°

1. ë¹ˆ ëœë”© í˜ì´ì§€ ìƒì„±
2. ë¹„ë””ì˜¤ì¹´ë“œ tamplateë§Œë“¤ê¸°
3. ëª½ê³  dbì—ì„œ ëª¨ë“  ë¹„ë””ì˜¤ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
4. ê°€ì ¸ì˜¨ ë¹„ë””ì˜¤ ë°ì´í„° ì¶œë ¥ (use map()methods)



#### ë¹„ë””ì˜¤ ë””í…Œì¼ í˜ì´ì§€

1. ë¹„ì–´ìˆëŠ” ë¹„ë””ì˜¤ ë””í…Œì¼ í˜ì´ì§€ ìƒì„±
2. ë¹„ë””ì˜¤ ë””í…Œì¼ í˜ì´ì§€ë¥¼ ìœ„í•œ route ë§Œë“¤ê¸°
3. ë¹„ë””ì˜¤ ë””í…Œì¼ í˜ì´ì§€ tamplateë§Œë“¤ê¸°
4. ëª½ê³ dbì—ì„œ ë¹„ë””ì˜¤ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
5. ê°€ì ¸ì˜¨ ë°ì´í„°ë“¤ ìŠ¤í¬ë¦°ì— ì¶œë ¥



#### ì‚¬ì´ë“œ ë¹„ë””ì˜¤ í˜ì´ì§€ ë§Œë“¤ê¸°

1. side Video ë¶€ë¶„ layout template ë§Œë“¤ê¸°
2. í•œê°œì˜ ì¹´ë“œ template ë§Œë“¤ê¸°
3. DB ì—ì„œ ëª¨ë“  ë¹„ë””ì–´ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ê¸°
4. ë¶ˆëŸ¬ì˜¨ ë°ì´í„° í™”ë©´ì— ì¶œë ¥í•˜ê¸°



#### êµ¬ë…ê¸°ëŠ¥(1)

1. subscriber model ë§Œë“¤ê¸°
2. subscribe button uië§Œë“¤ê¸°
3. ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì–¼ë§ˆë‚˜ ë§ì€ ì‚¬ëŒì´ ë¹„ë””ì˜¤ ì—…ë¡œë“œí•œ ìœ ì €ë¥¼ êµ¬ë…í•˜ëŠ”ì§€ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
4. ë‚´ê°€ ì´ ë¹„ë””ì˜¤ ì—…ë¡œë“œí•œ ìœ ì €ë¥¼ êµ¬ë…í•˜ëŠ”ì§€ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
5. ê°€ì ¸ì˜¨ ì •ë³´ë“¤ í™”ë©´ì— ì¶œë ¥



#### êµ¬ë…ê¸°ëŠ¥(2)

1. êµ¬ë…í•˜ê¸° ê¸°ëŠ¥ ë§Œë“¤ê¸°(0 Subscribe)
2. êµ¬ë…ì·¨ì†Œí•˜ê¸° ê¸°ëŠ¥ ë§Œë“¤ê¸°(1 Subscribed)
   1. ì•„ì§ êµ¬ë…ì¤‘ì´ ì•„ë‹ˆë¼ë©´ -> êµ¬ë…
   2. ì´ë¯¸ êµ¬ë…ì¤‘ì´ë¼ë©´ -> êµ¬ë…í•´ì œ



#### êµ¬ë… ë¹„ë””ì˜¤ í˜ì´ì§€ ë§Œë“¤ê¸°

1. ë¹ˆ Subscriptioní˜ì´ì§€ ìƒì„±
2. Subscriptioní˜ì´ì§€ ë¼ìš°í„° ë§Œë“¤ê¸°
3. í…œí”Œë¦¿ ë§Œë“¤ê¸°
4. ë‚´ê°€ êµ¬ë…í•œ ìœ ì €ì˜ ë¹„ë””ì˜¤ë“¤ë§Œ ì„œë²„ì—ì„œ ê°€ì ¸ì˜¤ê¸°
5. ê°€ì ¸ì˜¨ ë¹„ë””ì˜¤ë¥¼ í™”ë©´ì— ì¶œë ¥í•˜ê¸°



#### ëŒ“ê¸€(1)

1. ëŒ“ê¸€ ë¶€ë¶„ êµ¬ì¡° ì„¤ëª…
2. Comment model ìƒì„±
3. ë””í…Œì¼ ë¹„ë””ì˜¤ í˜ì´ì§€ì— Comment Component ë§Œë“¤ê¸°



#### ëŒ“ê¸€(2)

1. Comment.jsì„ ìœ„í•œ template ë§Œë“¤ê¸°
2. handleChange func ë§Œë“¤ê¸°
3. onSubmit funcë§Œë“¤ê¸° -> 
4. ì €ì¥ëœ ëŒ“ê¸€ ë°ì´í„°ë¥¼ parent componentë¡œ ì—…ë°ì´íŠ¸ í•˜ê¸°
5. ì½˜ì†”ì°½ì—ì„œ ëŒ“ê¸€ ë¦¬ìŠ¤íŠ¸ í™•ì¸



#### ëŒ“ê¸€(3)

1. Comment.jsì—ë‹¤ê°€ SingleComment Componentë¥¼ ìƒì„±
2. Single Comment ë¥¼ ìœ„í•œ Template ìƒì„±
3. Open Reply func ì™€ handleChange func ë§Œë“¤ê¸°
4. OnSubmit func ë§Œë“¤ê¸°
5. ëª¨ë“  Comment ì •ë³´ë“¤ì„ ë°ì´í„° ë² ì´ìŠ¤ì—ì„œ ê°€ì ¸ì˜¤ê¸°
6. ì €ì¥ëœ ëŒ“ê¸€ì„ Parent Componentì—ë‹¤ê°€ ì—…ë°ì´íŠ¸



- SingleComment.js (props.refreshFunction)

- Comment.js (props.refreshFunction)

- DetailVideoPage.js(loadComments)



#### ëŒ“ê¸€ (4)

1. ReplyComment Componentë¥¼ Comment.jsì— ë§Œë“¤ê¸°
2. Replay Comment í…œí”Œë¦¿ì„ ë§Œë“¤ê¸°
3. Calculate Child Comment Number. ìì‹ ì½”ë©˜íŠ¸ê°€ ì–¼ë§ˆë‚˜ ë‹¬ë ¤ìˆëŠ”ì§€ ?!
4. Complete Comment System



#### Like & Dislike Frature

1. Like & dislike model ë§Œë“¤ê¸°
2. êµ¬ì¡°



í´ë¦­ - > like

case1. ì•„ë¬´ê²ƒë„ í´ë¦­ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´, ì¢‹ì•„ìš” 1 ì˜¬ë¦¬ê¸°

case2. ì¢‹ì•„ìš” ë²„íŠ¼ì´ ì´ë¯¸ í´ë¦­ë˜ì–´ ìˆë‹¤ë©´, ì¢‹ì•„ìš” 1 ë‚´ë¦¬ê¸°

case3. ì‹«ì–´ìš” ë²„íŠ¼ì´ ì´ë¯¸ í´ë¦­ë˜ì–´ ìˆë‹¤ë©´, ì¢‹ì•„ìš” 1ì˜¬ë¦¬ê³  / ì‹«ì–´ìš” 1 ë‚´ë¦¬ê¸°

í´ë¦­ - > dislike

case1. ì•„ë¬´ê²ƒë„ í´ë¦­ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´, ì‹«ì–´ìš” 1 ì˜¬ë¦¬ê¸°

case2. ì¢‹ì•„ìš” ë²„íŠ¼ì´ ì´ë¯¸ í´ë¦­ë˜ì–´ ìˆë‹¤ë©´, ì‹«ì–´ìš” 1 ë‚´ë¦¬ê¸°

case3. ì‹«ì–´ìš” ë²„íŠ¼ì´ ì´ë¯¸ í´ë¦­ë˜ì–´ ìˆë‹¤ë©´, ì‹«ì–´ìš” 1ì˜¬ë¦¬ê³  / ì¢‹ì•„ìš” 1 ë‚´ë¦¬ê¸°



#### Like & Dislike Feature (2) Template, Fetch Data



1. andtd ì„ ì´ìš©í•˜ì—¬ like & dislike ë²„íŠ¼ ë§Œë“¤ê¸°
2. í˜„ì¬ ì¢‹ì•„ìš” ì‹«ì–´ìš”ì— ëŒ€í•œ ì •ë³´ë¥¼ dbì—ì„œ ê°€ì ¸ì˜¤ê¸° -> ì¢‹ì•„ìš” ì‹«ì–´ìš” ìˆ«ì / ë‚´ê°€ ì¢‹ì•„ìš”ë‚˜ ì‹«ì–´ìš” ë‘˜ ì¤‘ í•˜ë‚˜ë¥¼ ì´ë¯¸ ëˆŒë €ëŠ”ì§€...
   - Request  ë³´ë‚¼ ë•Œ ë³€ìˆ˜ëŠ” Video ì— ê²ƒê³¼ Commentì— ê²ƒì´ ë‹¬ë¼ì•¼ í•œë‹¤



#### Like & Dislike Feature

1. onLikefunc ë§Œë“¤ê¸°
2. onDislike func ë§Œë“¤ê¸°





client -> npm install -> npm run build

index.js

"heroku-postbuild": "npm install --prefix client"ë¨¼ì € í´ë¼ì´ì–¸íŠ¸ ê°€ì„œ

ë””íŒ¬ë˜ì‹œ ë‹¤ ë‹¤ìš´ë°›ì•„ì•¼ í•œë‹¤. ê·¸ ë‹¤ìŒì—



NPM_CONFIG_PRODUCTION=false

í—¤ë¡œì¿ ëŠ”

  "devDependencies": {

â€‹    "http-proxy-middleware": "^0.19.1"

  } 

ì´ë¶€ë¶„ ë¬´ì‹œí•˜ê²Œ ë¨.





####  Deploy Fix Bugs



1. íŒŒì¼ ì‚­ì œ

```
git rm yarn.lock
git rm package-lock.json
```

- ì´ ëª…ë ¹ì–´ ë“¤ì„ ì¹˜ì…”ì„œ  ìš°ì„ ì€ yarn íŒŒì¼ì€ ì‚­ì œ

-  heroku logs --tail í–ˆëŠ”ë°  ì„œë²„ê°€ ì£½ì–´ìˆìœ¼ë©´  heroku restart

2. Procfile  file root directoryì— ë§Œë“¤ê¸°  

```
web: node server/index.js
```

3. ffmpeg ë¥¼  í—¤ë¡œì¿  ì„œë²„ì— ì ìš©

```
heroku buildpacks:add https://github.com/jonathanong/heroku-buildpack-ffmpeg-latest.git
```

4. ë‹¤ì‹œ  herokuë¥¼ deploy

```
git add .git commit -am " redeploy"
git push heroku master
```





